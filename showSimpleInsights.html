<!DOCTYPE html>
<html>
	<head>
		<title>MyDiary</title>
		<link rel="stylesheet" type="text/css" href="css/jquery.fullPage.css" />
		<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
		<link rel="stylesheet" type="text/css" href="css/base.css">
		<link rel="stylesheet" type="text/css" href="css/chart.css">
		<link rel="stylesheet" type="text/css" href="css/c3.css">
		<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
		<script src="libs/jquery.min.js"></script>

		<script src="libs/c3.js"></script>

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script type="text/javascript" src="libs/bootstrap.js"></script>
		<script type="text/javascript" src="libs/jquery.fullPage.js"></script>
	</head>
	<body>
		<header>
			<div class="row">
				<div class="col-3 text-left">
					<img src="images/logo-white.png" class="header-logo">
					<p class="logo-text">
						<span><strong>MY</strong></span>
						<span>DIARY</span>
					</p>	
				</div>
				<div class="row col-6 menu-buttons">
					<div class="col-4">
						<a href="showCoreInsights.html">
							<p class="menu-button-text">Core Insights</p>
						</a>
					</div>
					<div class="col-4 active">
						<a href="#">
							<p class="menu-button-text">Simple Language</p>
						</a>
					</div>
					<div class="col-4">
						<a href="showBasicInsights.html">
							<p class="menu-button-text">Basic Insights</p>
						</a>
					</div>
				</div>
				<div class="col-3 text-right">
					<img src="images/user-profile.jpg" class="user-profile-icon">
					<p class="user-profile-name">Sophia Brown</p>
					<img src="images/down-arrow.png" class="profile-more-icon">
				</div>
			</div>
		</header>
		
		<div class="container charts-main-container"> 
			<div class="col-12 mt-8">
				<h5><strong>Male vs Female this year</strong></h5>
			</div>
			<div class="row col-12 multiple-charts-container mt-4">
			</div>
			<div class="container col-12 single-chart-container mt-4">	
				<div class="col-12 text-left">
					<h5 class="text-left chart-title"><strong>Relative length of sent/received emails</strong></h5>
				</div>
				<div class="row col-12 mt-4" id="relativeLengthItem1">
					<div class="col-2 data-comparison-item text-left">
						<span class="data-comparison-item-icon blue"></span>
						<span class="data-comparison-item-value"></span>
						<span class="data-comparison-item-title"></span>
					</div>
					<div class="col-10 progress big blue">
					  <div class="progress-bar" role="progressbar" style="width: 0;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
				</div>
				<div class="row col-12" id="relativeLengthItem2">
					<div class="col-2 data-comparison-item text-left">
						<span class="data-comparison-item-icon red"></span>
						<span class="data-comparison-item-value"></span>
						<span class="data-comparison-item-title"></span>
					</div>
					<div class="col-10 progress big red">
					  <div class="progress-bar" role="progressbar" style="width: 0;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
				</div>
			</div>
		</div>
		<script src="https://d3js.org/d3.v3.min.js"></script>
		<script type="text/javascript" src="js/chart.js"></script>
	</body>
	<script type="text/javascript">

		var dataJson;
		var url = "https://api.myjson.com/bins/1g2nep";

		$(document).ready(function(){
			addInitialData();
		})

		function addInitialData(){
			$.getJSON( url, function( data ) {
			  if(data!=null){
			  	dataJson = data;
			  	$('.data-title').html("<strong>" + data.dataTitle + "</strong>");
			  	
			  	addCharts(data);
			  	addRelativeLengthData(data);
			  }
			});
		}

		function addRelativeLengthData(data){
			$('#relativeLengthItem1 > div > .data-comparison-item-title').text(data.chartComparisonItems[0]);
			$('#relativeLengthItem1 > div > .data-comparison-item-value').text(data.maleRelativeLengthEmails);
			$('#relativeLengthItem1 > div > .progress-bar').css('width', data.maleRelativeLengthEmails*100+'%').attr('aria-valuenow', data.maleRelativeLengthEmails*100);

			$('#relativeLengthItem2 > div > .data-comparison-item-title').text(data.chartComparisonItems[1]);
			$('#relativeLengthItem2 > div > .data-comparison-item-value').text(data.femaleRelativeLengthEmails);
			$('#relativeLengthItem2 > div > .progress-bar').css('width', data.femaleRelativeLengthEmails*100+'%').attr('aria-valuenow', data.femaleRelativeLengthEmails*100);
		}

		function addCharts(data){

			var charts = data.charts;
			console.log(charts);

			for(var i = 0; i < charts.length; i++){
				var chartId = "chart"+ i;
				var chartItemId = "chart_item_"+ i;
				var chartItem = "<div class='col-6 chart-item' id='" + chartItemId + "'></div";
				var chartHeaderItem = "<h6 class='text-left chart-title'><strong>" + charts[i].chartTitle + "</strong></h6>";
				var dataComparisonContainer = "<div class='text-left data-comparison-items'></div>";
				var chart = "<div class='lg-chart mt-4' id='" + chartId + "'></div>";

				$('.multiple-charts-container').append(chartItem);
				$('#' + chartItemId).append(chartHeaderItem);
				$('#' + chartItemId).append(dataComparisonContainer);
				$('#' + chartItemId).append(chart);
				$('#' + chartItemId + ' > .data-comparison-items').append(getDataComparisonItems(data.chartComparisonItems));
			 	
			 	drawChart("#"+chartId, charts[i].chartData, 0.6);
			}
		}

		function getDataComparisonItems(chartComparisonItems){

			var colorsClass = ["blue", "red"];
			var items = [];

			for(var j = 0; j < chartComparisonItems.length; j++){
				var additionalClass = colorsClass[j];
				var div = "<div class='data-comparison-item text-left'><span class='data-comparison-item-title'>" + chartComparisonItems[j] + "</span><span class='data-comparison-item-icon " + additionalClass + "'></span></div>";

				items.push(div);
			}

			return items;
		}

	</script>
</html>